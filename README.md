# testChat
##Мой дорогой читатель, этот проект создан прикола ради и не преследует каких-то серьезных целей, это своеобразная проба пера художника-абстракциониста.
##Проект сделан на fastapi. Это просто общий чат на вебсокете, благодаря которому все пользователи могут обмениваться сообщениями в общем чате.
##Все функции сделаны максимально минималистично, регистрация находится по адресу ```/auth/register```, для регистрации нужен только логин и пароль, форма входа находится на ```/auth/login``` всё отображается в swagger
##после входа происходит редирект на ```/chat```, где собственно и происходит чат.
###в общем, с этим проектом всё пошло не так с момента когда я решил сделать один общий чат, редис я прикрутил просто для галочки чтобы показать что я умею, по факту он служит только для быстрой выдачи токенов. Почему не сообщения? история сообщений отдается по вебсокету пачкой, кешировать это просто нецелесообразно, редис будет напрягаться впустую.
###также в проекте есть телеграм бот ```@UvedomlyatorMessagesbot```, если ему написать /start когда проект запущен - он запомнит ИД пользователя и будет с каждым новым сообщением дублировать его в телеге(реализовал через события модели в sqlalchemy).
###также сделал возможность использовать celery для чистки старых токенов, в общем она каждые пять минут чистит токены, оставляя 50(сейчас 3 токена, ибо я не собирался создавать 51 токен для теста)
##Запустить это можно либо как обычный python проект на fastapi(не рекомендуется):
```bash
git clone https://github.com/BOPOH1243/testChat.git
cd testChat
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
cd fapi
#скрипт init_postgres.sh нужен просто для установки и настройки БД postgresql, используйте на свой страх и риск
sudo bash init_postgres.sh
uvicorn app:app --reload
```

##также запустить можно через docker-compose(рекомендуется):
###создает три контейнера, в одном крутится БД postgresql, в другом крутится redis, в третьем - само приложение, порты прокидываются дефолтные, поэтому может конфликтовать с теми, что работают под системой
```bash
sudo docker-compose up --build
```
